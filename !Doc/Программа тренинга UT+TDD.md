## 1.1. TODO:
* [ ] Почитать про ScreenPlay, SerenityBDD и дополнить с блоке [08.Testing UI](08.Testing%20UI.md)
* [ ] Описать Example Mapping в [10. BDD](10.BDD.md)

## 1.2. Links
* (GitHub репозиторий)[https://github.com/bevzuk/ut-tdd]
* (Фото тренинга в Самаре)[https://photos.app.goo.gl/vVmrkP3rFsQvY37a7]
* (Фото тренинга в Райфе)[https://disk.yandex.ru/d/150AIWfx3GU3BP]

## 1.3. Подготовка

* [Source code](https://github.com/bevzuk/ut-tdd)

Получить последнюю версию
``` text
cd ~/<your working folder>
git clone https://github.com/bevzuk/ut-tdd.git
git checkout -b <your branch>
```

## Структура
1. [Начало](01.Начало.md)
2. [Парное программирование](02.Парное%20программирование.md)
3. [Unit Test](03.Unit%20Test.md)
4. [Fixture](04.Fixture.md)
5. [Stub/Mock/Spy](05.Дублеры.md)
6. [3 столба тестирования; Паттерны разработки модульных тестов](06.Patterns%20%26%20Antipatterns.md)
7. [Тестирование legacy кода](07.Legacy.md)
8. [Тестирование UI](08.Testing%20UI.md)
9. [Domain Specific Language (DSL)](09.DSL.md)
10. [Behaviour Driven Development (BDD)](10.BDD.md)
11. [Test Driven Development (TDD)](11.TDD.md)
12. [Transformation Priority Premise (TPP)](12.Transformation%20Priority%20Premise.md)
13. [Object Calisthenics](13.Object%20Calisthenics.md)
14. [Шаблоны красной и зеленой полосы](14.Шаблоны%20красной%20и%20зеленой%20полосы.md)
15. [Принципы разработки](15.Принципы%20разработки.md)
16. [Паттерны тестируемого дизайна](16.Паттерны%20тестируемого%20дизайна.md)
17. [Модель принятия решений](17.Модель%20принятия%20решений.md)
18. [Завершение](18.Завершение.md)

## 1.5. Unit Testing


    -   Модель принятия решений
        -   Бизнес модель
            -   Устойчивый или развивающийся бизнес?
            -   Поиск или масштабирование?
            -   Новый продукт или копия существующего?
            -   Инвестиции или собственные средства?
        -   Модель процессов
            -   Как организованы команды?
            -   Как принимаются решения?
            -   Кто несет ответственность?
            -   Какие циклы обратной связи?
        -   Модель требований
            -   Функциональные
            -   НФТ
                * Usability
                * Reliability
                * Availability
                * Portability
                * Testability
                * Scalability
                * Flexibility
                * Reusability
                * Maintainability
                * Supportability
                * Interoperability
                * Performance
                * Security
        -   Модель дизайна
            -   Архитектура
            -   Дизайн классов
        -   Модель реализации
            -   Как написать код
    -   https://photos.google.com/share/AF1QipM4blkk7aW1gCjKYsEJj9SngPxhdPRNcHanggVbgCugKyTkRUGb0GnsyxTu_I1Bqg/photo/AF1QipPxNqiYUBSl9BEdD1GIpQNt6ou5FXb01At_gOB8?key=TUNISk5qSkVvaHdia1p0aXNSSHN0YTByMzl0cEp3 



## Непонятные блоки
-   Роль фикстуры
    -   Фреймворк модульного тестирования 
    -   Разработка тест-кейса
    -   Разработка теста
    -   Простые сравнения
    -   Сложные сравнения
    -   Таймауты
    -   Исключения
    -   Параметризованные тесты

1.  ### Упражнение. Покрытие тестами легаси кода
    -   Задача: Попробовать ручками несколько приемов рефакторинга
        легаси кода с целью повышения тестируемости
        -   Extract & Override
        -   Рефакторинг статических классов в экземплярные
        -   Избавление от инфраструктурных зависимостей на примере
            DateTime.Now()
              

2.  ### Упражнение. Инъекция зависимостей

    -   Задача: Используя принцип DIP, внедрить зависимости между
        объектами разными способами
        -   Выделение интерфейса
        -   Инъекция через конструктор
        -   Инъекция через свойство или метод
        -   Инъекция через фабрику  
              

3.  ### Упражнение. IoC фреймворки

    -   Задача: Переписать ранее написанный код и тесты, используя IoC
        фреймворк
        -   Инъекция через конструктор с использованием IoC
        -   Инъекция через свойство или метод с использованием IoC  
              

4.  ### Упражнение. Иерархия тестовых классов

    -   Задача. Переписать ранее созданные тесты, вынеся общую логику в
        базовые классы
        -   Абстрактный инфраструктурный класс  
              

## 1.6. Ретроспектива


## 1.8. План на День 2

-   Хороший юнит тест
-   Квадранты тестирования
-   Mock фреймворки
-   Паттерны тестируемого дизайна
-   Тестирование UI
-   Паттерны и антипаттерны модульных тестов
-   Тестирование унаследованного кода
-   DSL как способ написания тестов на языке бизнеса

  
------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------
------------------------------------------------------------------------------------------

# 2. TDD

## 3.3. Программа тренинга






Паттерны разработки модульных тестов

-   Изолированные тесты  
    -   Антипример - тесты на UI
-   Список тестов  
    -   Сейчас
    -   Потом
-   Тестовые данные
    -   Понятные
    -   Информативные
    -   Непротиворечивые
-   Assert first
-   Тест-обяснение
    -   Как это работает
    -   Диаграмма последовательности -&gt; тест
-   Тест-изучение
-   Регрессионный тест
-   Перерыв
    -   Dave Ungar - Shower methodology
    -   Усталость &lt;-&gt; Рассудительность
        -   Усталость мешает заметить, что устал
    -   Бутылка с водой
-   Начать с начала
-   Чистый коммит
-   Один красный тест
-   Не тестируйте нетестируемое

Шаблоны красной полосы

-   One-step Test
-   Starter Test
-   Another Test
-   Regression Test

Шаблоны зеленой полосы

-   Obvious Implementation
-   Triangulation
-   One to Many
    -   Суммирование коллекции

Анти-паттерны разработки модульных тестов

-   Много красных тестов
    -   3 точки скалолаза
-   Автогенеренный код
-   Элементарный код
-   Погоня за code coverage

Принципы

-   KISS
-   YAGNI
-   Tell don't ask
-   DRY
-   Закон Деметры
    -   Покупатель - Кассир - Кошелек - 100р

Тестабельный дизайн

-   Метрика Coupling
    -   Changes in one forces change in another

    -   Example: audio system analog -&gt; digital

-   Метрика Cohesion
    -   Whether its responsibilities form a meaningful unit
        -   Example: class that parses both dates and URLs
        -   Machine that washes both clothes and dishes
        -   Class that parses only the punctuation of URL doesn't
            represent a whole concept either

Проектирование удобного и поддерживаемого API через тесты

-   ООП - про общение

Шаблоны тестабельного дизайна

-   Ходячий скелет
    -   Лунная программа
-   Разделение ответственностей
    -   Причина для изменения
    -   Разделение создания и логики
-   Связи
    -   Зависимость
        -   Конструктор
    -   Оповещение
    -   Настройка  
        -   Strategy
        -   TableCellRenderer (RGB -&gt; HUE)
    -   Пример: лог - зависимость или оповещение?
    -   Интерфейсы
-   Скрывайте сложность
    -   Часы
-   Независимость от контекста выполнения
    -   Постоянное - в конструктор
    -   Транзиентное - в параметр
-   Immutable objects (Value type)
    -   Контроль типов
        -   Mars Climate Orbiter (ft/m)
    -   3 способа
        -   Breaking out
            -   Разделение
            -   Код - это эксперимент
        -   Budding off
            -   Выделение новой сущности
        -   Bundling up
            -   Композиция используемых вместе сущностей
-   Replace ifs/switch with polymorphism
    -   1 + 2 \* 3
    -   Behavior changes based on state
    -   Parallel conditionals are in multiple places 
-   Фабричный метод
-   Шаблон ServiceLocator
    -   Недостатки
-   Шаблон DI
    -   Конструктор
        -   Постоянная
        -   Жизненный цикл &gt;
    -   Свойство
    -   Параметр
        -   Жизненный цикл &lt;
-   Немутабельные объекты
-   Команда / запрос
-   Накопление в параметре

Преимущества и недостатки TDD

-   Самостоятельное обсуждение
-   Дебриф

Внедрение в процесс разработки

-   Затраты на TDD
-   Постановка экономической задачи
-   Общение с менеджментом
-   Secure sandbox
-   Последовательное расширение tdd scope

Типовые ошибки использования и внедрения

-   Code First
-   Too Many Obvious Implementation
-   Too Many Triangulations
-   Coverage Affinity
-   Implementation Testing not Contract Testing

Переход от TDD к ATDD

Вопросы и ответы

-   Приемы из реальной жизни.
-   Как и когда писать тесты?
-   Как и когда фиксить баги?
-   Как работать с легаси кодом и как гасить технический долг?
-   Как писать тесты на легаси код?
-   Как выглядит рабочий день девелопера?

Заключение


## 3.5. Упражнения


### 3.5.3. Упражнение 3. Выигрыш/проигрыш

-   Я, как игрок, могу проиграть, если сделал неправильную ставку
-   Я, как игрок, могу выиграть 6 ставок, если сделал правильную ставку
-   Я, как казино, получаю фишки, которые проиграл игрок
-   Я, как игрок, могу сделать несколько ставок на разные числа и
    получить выигрыш по тем, которые выиграли

### 3.5.4. Упражнение 4. Несколько кубиков

-   Я, как крупье, могу сделать игру с двумя кубиками
-   Я, как игрок, могу делать ставки на числа от 2 до 12
-   Я, как казино, определяю выигрышный коэффициент по вероятности
    выпадения того или иного номера 
-   2  3  4  5 6 7 8 9 10 11 12 

        36 18 12 9 7 6 7 9 12 18 36

### 3.5.5. Упражнение 5. Рулетка

-   Я, как казино, могу предложить игрокам сыграть в рулетку
-   Я, как игра, выбрасываю числа от 0 до 36 с равной вероятностью
-   Я, как игрок, могу делать ставки на чет/нечет. Выигрышный
    коэффициент = 1
-   Я, как игрок, теряю половину ставки при выпадении 0

## 3.6. Книги

### 3.6.1. Вообще

  

![](https://upload.wikimedia.org/wikipedia/en/thumb/8/8f/The_pragmatic_programmer.jpg/220px-The_pragmatic_programmer.jpg){height="250"}[![](https://images-na.ssl-images-amazon.com/images/I/41TINACY3hL._SX384_BO1,204,203,200_.jpg){height="250"}](https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882)[![](https://images-na.ssl-images-amazon.com/images/I/515iO%2B-PRUL._SX408_BO1,204,203,200_.jpg){height="250"}](https://www.amazon.com/Code-Complete-Practical-Handbook-Construction/dp/0735619670/ref=pd_sbs_14_img_0?_encoding=UTF8&psc=1&refRID=78JWG45NV0Y7PSFAS0VK)

### 3.6.2. Юнит тестирование

![](http://a.fsdn.com/sd/firehose/009/463/558-1.png){width="199"
height="250"}![](http://xunitpatterns.com/Cover-Small.gif){height="250"}

### 3.6.3. TDD

![](http://vig-fp.prenhall.com/bigcovers/0321146530.jpg){height="250"}

  

### 3.6.4. Тестируемый дизайн

![](http://www.informit.com/ShowCover.aspx?isbn=0131177052){height="250"}![](http://www.informit.com/ShowCover.aspx?isbn=9780321125217&type=f){height="250"}![](http://www.informit.com/ShowCover.aspx?isbn=9780321127426&type=f){height="250"}

## 3.7. Какие навыки получат участники?

-   Смогут автоматизировать ручную работу.
-   Поймут, какую ценность несет Unit Testing и TDD.
-   Отработают механику TDD на практике.
-   Увидят, как строить дизайн постепенно, маленькими шагами.
-   Смогут двигаться с постоянной скоростью.
-   Поймут, как больше заниматься творческой, а не рутинной работой.
-   Увидят, как больше времени тратить на написание кода, а не
    "затяжной" дебаг.

## 3.8. Ценность для бизнеса

-   Делать тот продукт, который хочет заказчик (а не тот, который описан
    в документации)
-   Вносить изменения в продукт легче и дешевле.
-   Существенно снизить количество новых багов.
-   Раньше получать прибыль от продукта.
-   Увеличить мотивацию разработчиков.

## 3.9. Участники

-   .Net или С++ разработчики
-   Количество: 8 человек

## 3.10. Требования к участникам

-   Ноутбук с зарядкой
-   Visual Studio 2012 или 2013
-   ReSharper или Visual Assist
-   Git

## 3.11. Требования к помещению

-   Проектор
-   Wi-Fi
-   Столы, чтобы людям было комфортно сидеть в парах
-   Флипчарты (3 шт.)
-   Маркеры для флипчартов

ToDo List

-   Прочитать про шаблоны TDD
-   Настроить ветки
-   Настроить TeamCity
-   Маркеры
-   Скотч
-   Зарядка, удлинитель, адаптеры